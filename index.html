<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>Field Book</title>
  <style>
    :root{
      --bg:#ffffff; --card:#f9fafb; --muted:#4b5563; --text:#111827; --accent:#2563eb; --accent-2:#16a34a; --warn:#d97706; --bad:#dc2626; --calc:#f3f4f6; --calc-border:#e5e7eb; --border:#e5e7eb;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; background:var(--bg); color:var(--text); font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; -webkit-tap-highlight-color: transparent;}
    .wrap{max-width:900px;margin:0 auto;padding:clamp(8px,3vw,16px)}

    header{position:sticky; top:0; z-index:30; background:rgba(255,255,255,.96); backdrop-filter:saturate(180%) blur(6px); border-bottom:1px solid var(--border)}
    .head{display:grid; grid-template-columns: 1fr; gap:8px; padding:8px 0}
    .status{justify-self:end}
    .meta{display:grid; grid-template-columns: 1fr; gap:8px}
    .meta input{width:100%}

    .card{background:var(--card); border:1px solid var(--border); border-radius:12px; padding:10px}

    .toolbar{display:grid; grid-template-columns: 1fr 1fr; gap:8px}
    .toolbar .seg{grid-column: span 2}
    .toolbar .wide{grid-column: span 2}
    @media (min-width:560px){ .toolbar{grid-template-columns: repeat(4,1fr)} }

    button, .seg label{appearance:none; border:1px solid var(--border); background:#ffffff; color:var(--text); padding:12px; border-radius:10px; font-weight:700; font-size:16px; letter-spacing:.2px; cursor:pointer; user-select:none}
    button.primary{background:var(--accent); border-color:var(--accent); color:#fff}
    button.ghost{background:#fff}
    .seg{display:inline-flex; border:1px solid var(--border); border-radius:10px; overflow:hidden}
    .seg input{display:none}
    .seg label{padding:10px 12px; border:0; background:#fff}
    .seg input:checked + label{background:#eff6ff; color:#1d4ed8}

    .chips{display:flex; gap:8px; flex-wrap:wrap}
    .chip{padding:6px 10px; border:1px solid var(--border); border-radius:999px; font-size:12px; color:var(--muted); background:#fff}

    table{width:100%; border-collapse:separate; border-spacing:0; margin-top:8px; table-layout:fixed}
    colgroup col.sta{width:20%}
    colgroup col.small{width:16%}
    thead th{position:sticky; top:96px; z-index:20; background:#fff; color:var(--muted); font-weight:700; text-align:left; border-bottom:1px solid var(--border); padding:8px; font-size:13px}
    tbody td{border-bottom:1px solid var(--border); padding:6px 8px; font-size:16px; vertical-align:middle}

    .cell-edit{background:#fff; border:1px solid var(--border); border-radius:8px; min-height:44px}
    .cell-edit:focus-within{outline:0; border-color:#60a5fa; box-shadow:0 0 0 3px rgba(59,130,246,.25)}
    .cell-calc{background:var(--calc); color:#111827; border-radius:8px; border:1px solid var(--calc-border)}
    .cell-input{width:100%; background:transparent; border:0; color:var(--text); font:600 18px Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; padding:10px 8px; outline:none}
    .cell-input::placeholder{color:#9ca3af}

    .qa-green{background:rgba(22,163,74,.1)!important; color:#166534!important}
    .qa-yellow{background:rgba(234,179,8,.15)!important; color:#92400e!important}
    .qa-red{background:rgba(220,38,38,.12)!important; color:#991b1b!important}

    .footerbar{position:sticky; bottom:0; z-index:20; margin-top:10px}
    .footerbar .card{display:flex; gap:10px; align-items:center; justify-content:space-between}

    input, select{background:#fff; color:var(--text); border:1px solid var(--border); border-radius:10px; padding:12px}
    input::placeholder{color:#9ca3af}
  </style>
</head>
<body>
  <header>
    <div class="wrap head">
      <div class="meta">
        <input id="jobTitle" placeholder="Job Title" />
        <input id="jobDate" type="date" />
      </div>
      <div class="status"><span class="chip" id="statusChip">Ready</span></div>
    </div>
  </header>

  <main class="wrap" id="app">

    <div class="card" style="margin-bottom:10px">
      <div class="toolbar">
        <button id="newSetupBtn" class="primary">+ New Setup</button>
        <button id="addBsBtn">+ Add BS</button>
        <button id="addFsBtn">+ Add FS</button>
        <div class="seg wide" title="HI aggregator">
          <input type="radio" name="agg" id="aggMedian" checked>
          <label for="aggMedian">Median HI</label>
          <input type="radio" name="agg" id="aggMean">
          <label for="aggMean">Mean HI</label>
        </div>
        <button id="lockToggle" class="ghost wide" title="Lock/unlock current setup">ðŸ”’ Lock</button>
      </div>
    </div>
        <div class="seg" title="HI aggregator">
          <input type="radio" name="agg" id="aggMedian" checked>
          <label for="aggMedian">Median HI</label>
          <input type="radio" name="agg" id="aggMean">
          <label for="aggMean">Mean HI</label>
        </div>
        <button id="lockToggle" class="ghost" title="Lock/unlock current setup">ðŸ”’ Lock</button>
      </div>
    </div>

    <div class="chips" id="setupTabs"></div>

    <div class="card">
      <table id="grid">
        <colgroup>
          <col class="sta" />
          <col class="small" />
          <col class="small" />
          <col class="small" />
          <col class="small" />
          <col class="small" />
        </colgroup>
        <thead>
          <tr>
            <th>STA</th>
            <th>BS</th>
            <th>HI</th>
            <th>FS</th>
            <th>ELEV</th>
            <th>GPS</th>
          </tr>
        </thead>
        <tbody id="gridBody"></tbody>
      </table>
    </div>

    <div class="footerbar">
      <div class="card">
        <div id="summary">Setups: 0 â€¢ BS: 0 â€¢ FS: 0 â€¢ G/Y/R: 0/0/0</div>
        <div>
          <button id="saveBtn">Save</button>
          <button id="resetBtn" class="ghost">Reset</button>
        </div>
      </div>
    </div>

  </main>

  <script src="app.js?v=2025-10-30-1"></script>
</body>
</html>