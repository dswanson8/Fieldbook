:root{--bg:#ffffff;--card:#f9fafb;--muted:#4b5563;--text:#111827;--accent:#2563eb;--accent-2:#16a34a;--warn:#d97706;--bad:#dc2626;--calc:#f3f4f6;--calc-border:#e5e7eb;--border:black}*{-webkit-box-sizing:border-box;box-sizing:border-box}html,body{height:100%}body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;-webkit-tap-highlight-color:#fff0;padding:5px}.wrap{max-width:900px;margin:0 auto}header{position:sticky;top:0;z-index:30;background:rgb(255 255 255 / .96);-webkit-backdrop-filter:saturate(180%) blur(6px);backdrop-filter:saturate(180%) blur(6px)}.head{display:-ms-grid;display:grid;-ms-grid-columns:1fr;grid-template-columns:1fr;gap:8px;padding:8px 0}.meta{display:-ms-grid;display:grid;-ms-grid-columns:1fr;grid-template-columns:1fr;gap:8px}.meta input{width:100%}.text-blue{color:blue}.text-orange{color:orange}.bold{font-weight:600}.card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:10px}.text-small{font-size:13px}.delta-up{color:#059669;font-weight:700}.delta-down{color:#dc2626;font-weight:700}.delta-zero{color:#6b7280;font-weight:600}.toolbar .seg{-ms-grid-column-span:2;grid-column:span 2}.toolbar .wide{-ms-grid-column-span:2;grid-column:span 2}@media (min-width:560px){.toolbar{-ms-grid-columns:(1fr)[4];grid-template-columns:repeat(4,1fr)}}.addBtn{display:-webkit-box;display:-ms-flexbox;display:flex;gap:10px}button,.seg label{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:1px solid var(--border);background:#fff;color:var(--text);padding:12px;border-radius:10px;font-weight:700;font-size:16px;letter-spacing:.2px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:block;width:100%;margin:10px 0;border:2px solid #000}button.primary{background:var(--accent);border-color:var(--accent);color:#fff}button.ghost{background:#fff}.seg{display:-webkit-box;display:-ms-flexbox;display:flex;overflow:hidden;gap:10px}.seg input{display:none}.seg label{padding:10px 12px;background:#fff;text-align:center;margin:0}.seg input:checked+label{background:#9cc7ff;color:#1d4ed8}.chips{display:-ms-grid;display:grid;gap:8px;grid-template-columns:repeat(auto-fit,minmax(0,1fr))}.chip{text-align:center;padding:8px 0;border:1px solid var(--border);border-radius:8px;font-size:14px;font-weight:600;color:var(--muted);background:#fff}#scSetsBar{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;gap:4px;margin-bottom:4px}#scSetsBar .chip{margin:0;width:19%;padding-left:4px;padding-right:4px;font-size:10px}#addExistingBsBtn{margin:0;background-color:skyblue}#bsPickerClose{display:block;width:auto}.bs-grid{display:-ms-grid;display:grid;-ms-grid-columns:(1fr)[3];grid-template-columns:repeat(3,1fr)}@media (max-width:545px){.bs-grid{-ms-grid-columns:(1fr)[1];grid-template-columns:repeat(1,1fr)}}.bs-btn{padding:10px;border:1px solid var(--border);border-radius:10px;background:#fff;font-weight:700;text-align:left}.bs-btn .bs-meta{display:block;color:#6b7280;font-weight:400;font-size:14px;margin-top:4px}.chip button{width:-webkit-min-content;width:-moz-min-content;width:min-content}table{width:100%;border-collapse:separate;border-spacing:0;margin-top:8px;table-layout:fixed}colgroup col.sta{width:22%}colgroup col.small{width:15.6%}thead th{position:sticky;top:92px;z-index:20;background:#fff;color:var(--muted);font-weight:700;text-align:left;border-bottom:1px solid var(--border);padding:8px;font-size:13px}tbody td{border-bottom:1px solid var(--border);font-size:16px;vertical-align:middle}.cell-edit{background:#fff;border:1px solid var(--border);min-height:44px}.cell-edit:focus-within{outline:0;border-color:#60a5fa;-webkit-box-shadow:0 0 0 3px rgb(59 130 246 / .25);box-shadow:0 0 0 3px rgb(59 130 246 / .25)}.cell-calc{color:#111827;border:1px solid var(--calc-border);text-align:center}.cell-input{width:100%;background:#fff0;border:0;color:var(--text);font:600 12px Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;outline:none;padding:10px 2px;font-size:12px;text-align:center}.cell-input--manual{border:1px solid #000;display:block;width:80%;margin:5px auto;padding:2px;border-radius:0;text-align:center}.cell-input::-webkit-input-placeholder{color:#9ca3af}.cell-input::-moz-placeholder{color:#9ca3af}.cell-input:-ms-input-placeholder{color:#9ca3af}.cell-input::-ms-input-placeholder{color:#9ca3af}.cell-input::placeholder{color:#9ca3af}.pipe-thick{position:relative;display:-ms-grid;display:grid;-ms-grid-rows:30% 70%;grid-template-rows:30% 70%}.pipe-thick label{font-size:10px;font-weight:700}.qa-green{background:rgb(22 163 74 / .1)!important;color:#166534!important}.qa-yellow{background:rgb(234 179 8 / .15)!important;color:#92400e!important}.qa-red{background:rgb(220 38 38 / .12)!important;color:#991b1b!important}.footerbar{position:sticky;bottom:0;z-index:20;margin-top:10px}.footerbar .card{display:block}input,select{background:#fff;color:var(--text);border:1px solid var(--border);border-radius:10px;padding:12px;width:100%;text-transform:uppercase}input::-webkit-input-placeholder{color:#9ca3af}input::-moz-placeholder{color:#9ca3af}input:-ms-input-placeholder{color:#9ca3af}input::-ms-input-placeholder{color:#9ca3af}input::placeholder{color:#9ca3af}#summary{font-size:12px}#summary b{color:#111;font-weight:700}.hi-active{background:#dcfce7;color:#166534;padding:2px 6px;border-radius:6px;font-weight:700}.hidden{display:none}.sheet.hidden{display:none}.sheet{position:fixed;inset:0;z-index:60}.sheet-backdrop{position:absolute;inset:0;background:rgb(0 0 0 / .25)}.sheet-panel{position:absolute;left:0;right:0;bottom:0;background:#fff;border-top-left-radius:16px;border-top-right-radius:16px;-webkit-box-shadow:0 -8px 24px rgb(0 0 0 / .2);box-shadow:0 -8px 24px rgb(0 0 0 / .2);padding:12px;min-height:75vh;max-height:90vh;overflow:auto}.sheet-header{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin-bottom:20px;font-weight:700;gap:5px}.tool-card{border:1px solid var(--border);border-radius:12px;padding:10px;background:#fff}.tool-title{font-weight:700;margin-bottom:8px}.tool-grid{display:-ms-grid;display:grid;-ms-grid-columns:1fr 8px 1fr;grid-template-columns:1fr 1fr;gap:8px}@media (min-width:560px){.tool-grid{-ms-grid-columns:(1fr)[3];grid-template-columns:repeat(3,1fr)}}.sc-field{display:-ms-grid;display:grid;gap:4px;-ms-grid-columns:2fr 4px 1fr;grid-template-columns:2fr 1fr}.sc-field input{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;min-width:0}.sc-pick-btn{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;padding:4px 8px;font-size:11px;margin:0;white-space:nowrap;background-color:khaki}#scPickerClose{width:auto;margin-left:auto}#toolsClose,#gradeSpotsClose,#asbPickerClose{display:block;width:auto;margin-left:auto;margin-top:0;margin-bottom:0}.tool-results{margin-top:8px;padding:8px;border:1px solid var(--border);border-radius:8px;background:#f9fafb;color:#111;min-height:40px}.tool-actions{display:-webkit-box;display:-ms-flexbox;display:flex;gap:8px;margin-top:8px}.mini-hint{font-size:12px;text-align:center}.mini-hint b{font-size:13px;background-color:#ff0}.grade-row-meta td{padding:4px 8px;background:#f7f7f7;border-bottom:1px solid #e0e0e0}.grade-meta-bar{display:-webkit-box;display:-ms-flexbox;display:flex;gap:8px;font-size:11px}.grade-toggle-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:4px}.grade-toggle-label{opacity:.7;font-size:10px;text-transform:uppercase}.grade-chip{padding:2px 6px;border-radius:999px;border:1px solid #d0d0d0;background:#fff;font-size:10px;line-height:1.3;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.grade-chip--active{background:#dbeafe;border-color:#60a5fa;font-weight:600}.delta-badge{display:inline-block;font-size:11px;border-radius:2px;font-weight:700;line-height:1.2}.delta-badge.green{background:rgb(22 163 74 / .10);color:#166534}.delta-badge.red{background:rgb(220 38 38 / .12);color:#991b1b}.delta-badge.neutral{background:#eef2f7;color:#374151;font-weight:600}